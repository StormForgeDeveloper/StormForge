<?xml version="1.0" encoding="UTF-8"?>
<Protocols xmlns="http://www.StormForge.com/XMLProtocol" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.StormForge.com/XMLProtocol ../../StormForge/Engine/Data/Protocol/ProtocolDef.xsd">
	<ProtocolGroup Name="PlayInstance" IsMobile="false" GenCSharp="true" Desc="PlayInstance Protocol">

		<!-- ============================  Game instance ============================================ -->

		<Command Name="JoinPlayInstance" Reliable="true" Crypto="Mask" Trace="Debug1" Desc="Player Join request.">
			<Cmd>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance to join"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="Joining player id"/>
				<Params TypeName="String" Name="PlayerIdentifier" Desc="Joining player identifier. string value"/>
			</Cmd>
			<Res>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="joined Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="Joined player id for validation"/>
				<Params TypeName="ActorMovement" Name="Movement" Desc="Start movement"/>
			</Res>
		</Command>

		<S2CEvent Name="PlayerKicked" Reliable="true" Crypto="No" Trace="Debug1" Desc="Player kicked event. this event will be broadcasted when a player kicked.">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="KickedPlayerID" Desc="Kicked player ID"/>
		</S2CEvent>

		<C2SEvent Name="PlayPacket" Reliable="false" Crypto="No" Trace="Debug1" Desc="Play packet">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="uint32" Name="SenderEndpointID" Desc="Sender player ID"/>
			<Params TypeName="uint32" Name="TargetEndpointMask" Desc="Target Play mask."/>
			<Params TypeName="uint8" IsArray="true" Name="Payload" Desc="Payload data"/>
		</C2SEvent>


		<!-- ============================= Player movement  ======================================= -->


		<S2CEvent Name="NewPlayerInView" Reliable="true" Crypto="No" Trace="Debug1" Desc="New Player in get view">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Joined Player Id"/>
			<Params TypeName="VariableTable" Name="Attributes" Desc="Character visual data"/>
			<Params TypeName="ActorMovement" Name="Movement" Desc="Actor movement of the character"/>
			<Params TypeName="StringCrc32" Name="State" Desc="StateId actor state."/>
			<Params TypeName="VariableTable" Name="StateValues" Desc="State values"/>
		</S2CEvent>

		<S2CEvent Name="RemovePlayerFromView" Reliable="true" Crypto="No" Trace="Debug1" Desc="Remove player from view">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Removed Player Id"/>
		</S2CEvent>


		<C2SEvent Name="PlayerMovement" Reliable="false" Crypto="No" Trace="Debug3" Desc="Player Movement">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Player Id"/>
			<Params TypeName="ActorMovement" Name="Movement" Desc="Movement attributes"/>
		</C2SEvent>

		<S2CEvent Name="PlayerMovement" Reliable="false" Crypto="No" Trace="Debug4" Desc="Player Movement">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Player Id"/>
			<Params TypeName="ActorMovement" Name="Movement" Desc="Movement attributes"/>
		</S2CEvent>

		<S2CEvent Name="PlayerStateChanged" Reliable="true" Crypto="No" Trace="Debug1" Desc="Player state change">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Player Id"/>
			<Params TypeName="StringCrc32" Name="State" Desc="StateId actor state."/>
			<Params TypeName="uint32" Name="MoveFrame" Desc="Movement frame state change has happened"/>
			<Params TypeName="Vector4" Name="Position" Desc="Position of the player when state change happened"/>
			<Params TypeName="VariableTable" Name="StateValues" Desc="State change values"/>
		</S2CEvent>

		<C2SEvent Name="ClientSyncReliable" Reliable="true" Crypto="No" Trace="Debug1" Desc="Repliable player Sync packet. We shares packet for C2S and S2C, meaning other clients will receive same packet">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Player Id"/>
			<Params TypeName="VariableTable" Name="SyncData" Desc="sync data"/>
		</C2SEvent>

		<C2SEvent Name="ClientSync" Reliable="false" Crypto="No" Trace="Debug1" Desc="Player Sync packet. We shares packet for C2S and S2C, meaning other clients will receive same packet">
			<Params TypeName="GameInsUID" Name="PlayInstanceUID" Desc="Game instance UID"/>
			<Params TypeName="PlayerID" Name="PlayerID" Desc="Player Id"/>
			<Params TypeName="VariableTable" Name="SyncData" Desc="sync data"/>
		</C2SEvent>


		<!-- ============================= Object interection ======================================= -->

		<Command Name="OccupyMapObject" Reliable="true" Crypto="Mask" Trace="Debug1" Desc="Occupy map object">
			<Cmd>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id"/>
				<Params TypeName="uint32" Name="MapObjectId" Desc="MapObjectId"/>
				<Params TypeName="uint32" Name="UsageId" Desc="MapObjectOccupyMode "/>
			</Cmd>
			<Res>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id for validation"/>
				<Params TypeName="uint32" Name="MapObjectId" Desc="MapObjectId"/>
			</Res>
		</Command>

		<Command Name="UnoccupyMapObject" Reliable="true" Crypto="Mask" Trace="Debug1" Desc="Unoccupy map object">
			<Cmd>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id"/>
				<Params TypeName="uint32" Name="MapObjectId" Desc="MapObjectId"/>
			</Cmd>
			<Res>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id for validation"/>
				<Params TypeName="uint32" Name="MapObjectId" Desc="MapObjectId"/>
			</Res>
		</Command>

		<Command Name="UseMapObject" Reliable="true" Crypto="Mask" Trace="Debug1" Desc="Use map object">
			<Cmd>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id"/>
				<Params TypeName="StringCrc32" Name="MapObjectId" Desc="MapObjectId"/>
				<Params TypeName="VariableTable" Name="UseParameters" Desc="use parameters"/>
			</Cmd>
			<Res>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id for validation"/>
				<Params TypeName="StringCrc32" Name="MapObjectId" Desc="MapObjectId"/>
				<Params TypeName="VariableTable" Name="ResultAttributes" Desc="Use result attributes"/>
			</Res>
		</Command>

		<Command Name="HarvestArea" Reliable="true" Crypto="Mask" Trace="Debug1" Desc="Havest area">
			<Cmd>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id"/>
				<Params TypeName="StringCrc32" Name="AreaId" Desc="Area Id"/>
			</Cmd>
			<Res>
				<Params TypeName="EntityUID" Name="PlayInstanceUID" Desc="Play instance ID"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="player id for validation"/>
				<Params TypeName="StringCrc32" Name="AreaId" Desc="Area Id"/>
				<Params TypeName="VariableTable" Name="ResultAttributes" Desc="Use result attributes"/>
			</Res>
		</Command>


		<!-- ============================  Streaming ============================================ -->

		<Command Name="CreateStream" Reliable="true" Crypto="No" Trace="Debug1" Desc="Create stream instance">
			<Cmd>
				<Params TypeName="AuthTicket" Name="Ticket" Desc="Login session Ticket"/>
				<Params TypeName="String" Name="StreamName" Desc="Stream name"/>
			</Cmd>
			<Res>
				<Params TypeName="String" Name="StreamName" Desc="Stream name"/>
			</Res>
		</Command>

		<Command Name="FindStream" Reliable="true" Crypto="No" Trace="Debug1" Desc="Open stream instance">
			<Cmd>
				<Params TypeName="AuthTicket" Name="Ticket" Desc="Login session Ticket"/>
				<Params TypeName="String" Name="StreamName" Desc="Stream name"/>
			</Cmd>
			<Res>
				<Params TypeName="String" Name="StreamName" Desc="Stream name"/>
			</Res>
		</Command>

		<Command Name="DeleteStream" Reliable="true" Crypto="No" Trace="Debug1" Desc="Delete stream instance">
			<Cmd>
				<Params TypeName="AuthTicket" Name="Ticket" Desc="Login session Ticket"/>
				<Params TypeName="String" Name="StreamName" Desc="stream name to delete"/>
			</Cmd>
			<Res>
				<Params TypeName="String" Name="StreamName" Desc="Stream name"/>
			</Res>
		</Command>

		<Command Name="GetStreamList" Reliable="true" Crypto="No" Trace="Debug1" Desc="Get stream list">
			<Cmd>
				<Params TypeName="AuthTicket" Name="Ticket" Desc="Login session Ticket"/>
			</Cmd>
			<Res>
				<Params TypeName="String" Name="StreamNames" IsArray="true" Desc="Stream names"/>
			</Res>
		</Command>

		<!-- <C2SEvent Name="NewStreamPacket" Reliable="true" Crypto="No" Trace="Debug1" Desc="Play packet"> -->
		<!-- <Params TypeName="String" Name="StreamUID" Desc="Unique stream Id to delete"/> -->
		<!-- <Params TypeName="uint32" Name="SenderEndpointID" Desc="Sender player ID"/> -->
		<!-- <Params TypeName="uint32" Name="TargetEndpointMask" Desc="Target Play mask."/> -->
		<!-- <Params TypeName="uint8" IsArray="true" Name="Payload" Desc="Payload data"/> -->
		<!-- </C2SEvent> -->


		<!-- <S2CEvent Name="StreamPacket" Reliable="true" Crypto="No" Trace="Debug1" Desc="Event for Player left."> -->
		<!-- <Params TypeName="uint32" Name="PlayInstanceID" Desc="Play Instance id"/> -->
		<!-- <Params TypeName="PlayerID" Name="LeftPlayerID" Desc="Left player ID"/> -->
		<!-- <Params TypeName="uint32" Name="KickedReason" Desc="Reason"/> -->
		<!-- </S2CEvent> -->



		<!-- =============================  ======================================= -->

		<Command Name="CallFunction" Reliable="true" Crypto="No" Trace="Debug1" Desc="To call general functionality">
			<Cmd>
				<Params TypeName="StringCrc32" Name="FunctionName" Desc="function name"/>
				<Params TypeName="PlayerID" Name="PlayerID" Desc="Caller player Id"/>
				<Params TypeName="VariableTable" Name="Parameters" Desc="function parameter"/>
			</Cmd>
			<Res>
				<Params TypeName="VariableTable" Name="Results" Desc="function result"/>
			</Res>
		</Command>

	</ProtocolGroup>
</Protocols>
